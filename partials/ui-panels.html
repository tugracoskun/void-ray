<!-- BÜYÜK HARİTA -->
<div id="big-map-overlay">
    <div class="big-map-layout">
        <div class="big-map-container">
            <canvas id="big-map-canvas"></canvas>
            
            <!-- KOORDİNAT GÖSTERGESİ -->
            <div id="big-map-coords" class="absolute bottom-4 left-4 text-xs font-mono bg-black/50 px-3 py-1 rounded border backdrop-blur-sm pointer-events-none" style="color: var(--hud-color); border-color: var(--hud-color-dim);">
                0 : 0
            </div>

            <div class="absolute bottom-4 right-4 flex gap-2">
                <!-- TAKİP MODU BUTONU -->
                <button id="btn-map-track" onclick="toggleMapTracking()" class="bg-white/10 hover:bg-white/20 text-white w-8 h-8 flex items-center justify-center rounded border border-white/10 backdrop-blur-sm transition active:scale-95" title="Oyuncuyu Takip Et">
                    ◎
                </button>

                <!-- HEDEF VEKTÖRLERİ GÖSTER BUTONU -->
                <button id="btn-map-targets" onclick="toggleMapTargets()" class="bg-white/10 hover:bg-white/20 text-white w-8 h-8 flex items-center justify-center rounded border border-white/10 backdrop-blur-sm transition active:scale-95" title="Hedef Vektörleri">
                    ⇢
                </button>

                <!-- MERKEZE ODAKLA BUTONU -->
                <button onclick="centerMapOnPlayer()" class="bg-white/10 hover:bg-white/20 text-white w-8 h-8 flex items-center justify-center rounded border border-white/10 backdrop-blur-sm transition active:scale-95" title="Merkeze Odakla">
                    ⌖
                </button>
            </div>
            
            <div class="radar-info-wrapper">
                <div class="radar-info-icon">?</div>
                <div class="radar-info-tooltip">
                    <h4 class="text-white font-bold mb-2 border-b border-white/20 pb-1 tracking-widest text-sm">RADAR SİSTEMİ</h4>
                    <div class="radar-legend-item"><div class="r-dot scan"></div><div><span class="r-title text-emerald-400">TARAMA ALANI</span><p class="r-desc">Tam Görüş. Kaynakların içeriği net tespit edilir.</p></div></div>
                    <div class="radar-legend-item"><div class="r-dot radar"></div><div><span class="r-title text-amber-400">RADAR ALANI</span><p class="r-desc">Kısmi Görüş. Nesneler sinyal olarak görünür.</p></div></div>
                    <div class="radar-legend-item"><div class="r-dot unknown"></div><div><span class="r-title text-gray-400">BİLİNMEYEN BÖLGE</span><p class="r-desc">Kapsama alanı dışı.</p></div></div>
                    <h4 class="text-white font-bold mb-2 mt-4 border-b border-white/20 pb-1 tracking-widest text-sm">HARİTA KONTROLLERİ</h4>
                    <div class="radar-legend-item"><div class="r-dot" style="background:transparent; border:1px solid rgba(255,255,255,0.5);"></div><div><span class="r-title text-white">OTO-PİLOT</span><p class="r-desc">Noktaya tıklayarak rota oluşturun.</p></div></div>
                    <div class="radar-legend-item"><div class="r-dot" style="background:transparent; border:1px solid rgba(255,255,255,0.5); border-radius:50%;"></div><div><span class="r-title text-white">YAKINLAŞTIRMA</span><p class="r-desc">Fare tekerleği ile zoom yapın.</p></div></div>
                    <div class="radar-legend-item"><div class="r-dot" style="background:transparent; border:1px solid rgba(255,255,255,0.5); border-radius:0;"></div><div><span class="r-title text-white">GEZİNME</span><p class="r-desc">Sol tık basılı tutarak kaydırın.</p></div></div>
                </div>
            </div>
            <div class="ui-close-btn" style="position: absolute; top: 1rem; right: 1rem; color: white;" onclick="closeMap()">✕</div>
        </div>
        <div class="big-map-info-overlay">
            <h3 class="text-white font-light tracking-widest text-lg mb-4 border-b border-white/10 pb-2">LEJANT</h3>
            <div class="legend-item"><div class="l-dot" style="background:#fff; border:2px solid var(--hud-color);"></div> SİZ</div>
            <div class="legend-item"><div class="l-dot" style="background:#fff; border:2px solid #fff;"></div> NEXUS</div>
            <div class="legend-item"><div class="l-dot" style="background:#10b981;"></div> TAMİR İSTASYONU</div>
            <div class="legend-item"><div class="l-dot" style="background:#a855f7;"></div> DEPO MERKEZİ</div>
            <div class="legend-item"><div class="l-dot" style="background:#67e8f9;"></div> YANKI</div>
            <div class="legend-item"><div class="l-dot" style="border:2px solid #8b5cf6;"></div> SOLUCAN DELİĞİ</div>
            <div class="legend-item"><div class="l-dot" style="background:rgba(255,255,255,0.5);"></div> Kaynak</div>
            <div class="legend-item"><div class="l-dot" style="background:#84cc16;"></div> Zehirli Bölge</div>
            <div class="legend-item"><div class="l-dot" style="background:#C7C0AE;"></div> Tardigrad</div>
            <div class="legend-item"><div class="l-dot" style="background:#a855f7;"></div> Kayıp Kargo</div>
            <div class="legend-item"><div class="l-dot" style="border:1px dashed #ef4444;"></div> Hedef</div>
        </div>
    </div>
</div>

<!-- BAĞLAM PENCERESİ -->
<div id="context-overlay" class="overlay-base">
    <div class="context-window compact">
        <div class="context-header">
            <h2 class="text-sm font-bold tracking-widest" style="color: var(--hud-color);">BAĞLAMLAR</h2>
            <div class="ui-close-btn" onclick="closeContext()">✕</div>
        </div>
        <div class="context-content">
            <div class="ctx-grid">
                <!-- Dinamik arka plan ve kenarlık rengi -->
                <div class="ctx-item full" style="background: var(--hud-color-dim); border-color: var(--hud-color);">
                    <div class="flex justify-between items-center mb-2 border-b border-white/10 pb-1">
                        <span class="ctx-lbl" style="color: var(--hud-text);">MAKSİMUM HIZ HESAPLAMASI</span>
                        <span id="ctx-speed-val" class="ctx-val text-lg" style="color: #fff;">0 KM/S</span>
                    </div>
                    <div id="ctx-speed-formula" class="font-mono text-xs space-y-1"></div>
                </div>
                <div class="ctx-item">
                    <div class="flex justify-between items-center mb-1">
                        <span class="ctx-lbl">KARGO</span>
                        <span id="ctx-cargo-val" class="ctx-val">0 / 0</span>
                    </div>
                    <div id="ctx-cargo-formula" class="ctx-formula">...</div>
                </div>
                <div class="ctx-item">
                    <div class="flex justify-between items-center mb-1">
                        <span class="ctx-lbl">SENSÖR</span>
                        <span id="ctx-sensor-val" class="ctx-val">0 km</span>
                    </div>
                    <div id="ctx-sensor-formula" class="ctx-formula">...</div>
                </div>
                <div class="ctx-item full">
                    <div class="flex justify-between items-center mb-1">
                        <span class="ctx-lbl">ENERJİ AKIŞI</span>
                        <span id="ctx-energy-rate" class="ctx-val">0.0/s</span>
                    </div>
                    <div id="ctx-energy-state" class="ctx-formula text-emerald-400">...</div>
                </div>
                <div class="ctx-item full border-l-2 border-red-500/50 mt-1">
                    <div class="flex justify-between items-center">
                        <div>
                            <div class="ctx-lbl text-red-300">ÇEVRESEL DURUM</div>
                            <div id="ctx-env-detail" class="text-[0.6rem] text-gray-500 italic mt-0.5">Analiz ediliyor...</div>
                        </div>
                        <div id="ctx-env-status" class="ctx-val text-sm">BİLİNMİYOR</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="stats-overlay" class="overlay-base">
    <div class="stats-window">
        <!-- JS tarafından dolduruluyor (stats.js) -->
    </div>
</div>

<div id="achievements-overlay" class="overlay-base">
    <div class="stats-window">
        <div class="stats-header">
            <div>
                <h2 class="text-2xl font-light tracking-widest text-white">BAŞARIMLAR</h2>
                <div id="ach-progress-text" class="text-xs text-gray-400 tracking-widest mt-1">0 / 0 TAMAMLANDI</div>
            </div>
            <div class="ui-close-btn" onclick="closeAchievements()">✕</div>
        </div>
        <div class="stats-content">
            <div id="achievements-list" class="space-y-2 p-2"></div>
        </div>
    </div>
</div>

<div id="storage-overlay" class="overlay-base">
    <div class="nexus-window" style="height: 800px;"> 
        <div class="nexus-header">
            <div>
                <h1 class="nexus-logo-text" style="font-size: 3rem;">MERKEZ DEPO</h1>
                <span class="text-xs text-gray-400 tracking-widest">SINIRSIZ SAKLAMA ALANI</span>
            </div>
            <div class="ui-close-btn" onclick="closeStorage()">✕</div>
        </div>
        <div class="nexus-content active" style="display:flex; gap:20px; height:100%; overflow:hidden;">
            <div class="storage-col" style="flex:1; background:rgba(0,0,0,0.3); border-radius:8px; display:flex; flex-direction:column;">
                <div class="p-4 border-b border-white/10 flex justify-between items-center">
                    <h3 class="tracking-widest" style="color: var(--hud-color);">GEMİ KARGOSU</h3>
                    <span id="storage-ship-cap" class="text-xs text-gray-400">0 / 150</span>
                </div>
                <div id="storage-ship-list" class="p-4 overflow-y-auto flex-1 space-y-2"></div>
                <div class="p-4 border-t border-white/10">
                    <button onclick="depositAllToStorage()" class="w-full bg-white/5 hover:bg-white/10 border py-2 rounded text-xs tracking-widest transition" style="color: var(--hud-color); border-color: var(--hud-color-dim);">TÜMÜNÜ DEPOLA</button>
                </div>
            </div>
            <div class="flex flex-col justify-center items-center text-gray-500"><div class="text-2xl">⇄</div></div>
            <div class="storage-col" style="flex:1; background:rgba(0,0,0,0.3); border-radius:8px; display:flex; flex-direction:column;">
                <div class="p-4 border-b border-white/10 flex justify-between items-center">
                    <h3 class="tracking-widest" style="color: var(--color-storage);">MERKEZ DEPO</h3>
                    <span id="storage-center-count" class="text-xs text-gray-400">0 EŞYA</span>
                </div>
                <div id="storage-center-list" class="p-4 overflow-y-auto flex-1 space-y-2"></div>
                <div class="p-4 border-t border-white/10">
                    <button onclick="withdrawAllFromStorage()" class="w-full bg-white/5 hover:bg-white/10 border py-2 rounded text-xs tracking-widest transition" style="color: var(--color-storage); border-color: rgba(168, 85, 247, 0.3);">TÜMÜNÜ AL</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="inventory-overlay" class="overlay-base">
    <div class="inv-window">
        <div style="display:flex; flex:1; overflow:hidden;">
            <div class="inv-content">
                <div class="inv-header">
                    <div>
                        <h2 class="text-2xl font-light tracking-[0.2em] text-white">ENVANTER</h2>
                        <div class="inv-currency">
                            <span style="color: var(--ray-color);">◆</span> <span id="stardust-amount" class="text-white font-bold">0</span>
                        </div>
                    </div>
                    <div class="ui-close-btn" id="btn-close-inv" onclick="closeInventory()">✕</div>
                </div>
                <div class="inv-table-container" id="inv-grid-content"></div>
            </div>
        </div>
    </div>
</div>

<div id="echo-inventory-overlay" class="overlay-base">
    <div class="nexus-window" style="height: 600px; border-color: var(--echo-color);">
        <div class="nexus-header">
            <div>
                <h1 class="nexus-logo-text" style="color:var(--echo-color); font-size: 2.5rem;">YANKI ARAYÜZÜ</h1>
                <span class="text-xs text-cyan-400 tracking-widest">SENKRONİZE DEPO YÖNETİMİ</span>
            </div>
            <div class="ui-close-btn" style="color: var(--echo-color);" onclick="closeEchoInventory()">✕</div>
        </div>
        <div class="nexus-content active" style="display:flex; gap:20px; height:100%; overflow:hidden;">
            <div class="storage-col" style="flex:1; background:rgba(0,0,0,0.3); border-radius:8px; display:flex; flex-direction:column;">
                <div class="p-4 border-b border-white/10 flex justify-between items-center">
                    <h3 class="tracking-widest" style="color: var(--hud-color);">GEMİ KARGOSU</h3>
                    <span id="echo-player-cap" class="text-xs text-gray-400">0 / 150</span>
                </div>
                <div id="echo-player-grid" class="p-4 overflow-y-auto flex-1 space-y-2"></div>
                <div class="p-4 border-t border-white/10">
                    <button onclick="transferAllToEcho()" class="w-full bg-white/5 hover:bg-white/10 border py-2 rounded text-xs tracking-widest transition" style="color: var(--hud-color); border-color: var(--hud-color-dim);">TÜMÜNÜ AKTAR</button>
                </div>
            </div>
            <div class="flex flex-col justify-center items-center text-cyan-500"><div class="text-2xl">⇄</div></div>
            <div class="storage-col" style="flex:1; background:rgba(0,0,0,0.3); border-radius:8px; display:flex; flex-direction:column;">
                <div class="p-4 border-b border-white/10 flex justify-between items-center">
                    <h3 class="tracking-widest" style="color: var(--echo-color);">YANKI DEPOSU</h3>
                    <span id="echo-storage-cap" class="text-xs text-gray-400">0 / 0</span>
                </div>
                <div id="echo-storage-grid" class="p-4 overflow-y-auto flex-1 space-y-2"></div>
                <div class="p-4 border-t border-white/10">
                    <button onclick="transferAllToPlayer()" class="w-full bg-white/5 hover:bg-white/10 border py-2 rounded text-xs tracking-widest transition" style="color: var(--echo-color); border-color: rgba(103, 232, 249, 0.3);">TÜMÜNÜ AL</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="nexus-overlay" class="overlay-base">
    <div class="nexus-window">
        <div class="nexus-header">
            <div>
                <h1 class="nexus-logo-text">NEXUS</h1>
                <span class="text-xs text-gray-400 tracking-widest">TİCARET VE GELİŞTİRME İSTASYONU</span>
            </div>
            <div class="nexus-tabs">
                <div class="nexus-tab active" onclick="switchNexusTab('market')">PAZAR</div>
                <div class="nexus-tab" onclick="switchNexusTab('upgrades')">HANGAR</div>
            </div>
            <div class="ui-close-btn" onclick="exitNexus()">✕</div>
        </div>
        <div id="tab-market" class="nexus-content active">
            <div class="flex justify-between items-center mb-6">
                <p class="text-gray-400">Elde edilen materyalleri Yıldız Tozu karşılığında takas et.</p>
                <button onclick="sellAll()" class="bg-white/10 text-white border border-white/20 px-6 py-2 rounded-sm hover:bg-white hover:text-black transition text-sm tracking-widest">TÜMÜNÜ SAT</button>
            </div>
            <div id="market-grid" class="market-grid"></div>
        </div>
        <div id="tab-upgrades" class="nexus-content">
            <div class="upgrade-grid">
                <!-- nexus.js içinde dinamik oluşturuluyor, orada da style="color: var(--hud-color)" yapılacak -->
                <div><div class="upgrade-col-title" style="color: var(--hud-color);">VOID RAY (SİZ)</div><div id="upg-player-list"></div></div>
                <div><div class="upgrade-col-title" style="color: var(--echo-color);">ECHO RAY (YANKI)</div><div id="upg-echo-list"></div></div>
            </div>
        </div>
    </div>
</div>